---
title: 震惊，web app 不能做的 N 件事
catalog: true
date: 2019-01-08 16:45:37
subtitle:
header-img: header.jpg
tags: [web app, pwa, 小程序, hybrid app]
---
大概四五年前，我离开了那家做 EBS 的公司，选择进入一家中国软件公司，做 **java** 。虽然在此之前， 我的所有 **java** 的所有经验几乎都来自于业余练习，但凭着能说会道（会忽悠）外加技术确实不错（在第一家公司造了一些轮子），还是成功拿到了 offer，而且不止一份。最终选择家中国软件公司，完全是因为我想换个口味。

当然，我拒绝其他 offer 的时候，完全又是另一副冠冕堂皇的嘴脸。
“对不起，我深思熟虑后，觉得自己不适合贵公司。非常抱歉。”

如果不是后来阴差阳错，又转而做起了 **js**，我的人生可能又会是另一番模样。谁知道呢？

# 和 js 的缘分

参加工作以来，经历过两段**闲的蛋疼**的日子。第一段是在第一家公司实习混日子的时候，天天聊天打屁看小说，《明朝那些事儿》就是那段时间用人生中第一部智能手机刷完的。

![phone.jpg](samsung-galaxy-mini-s5570.jpg)

第二段则是在第二家公司，也就是那家中国公司。

进入第二家公司后，大概 4 个月没什么正事，可是项目源码都翻烂了。百无聊赖，就开始学 js。语法很简单，可是光看语法写 1 + 1 有什么意思呢？ 于是就开始造各种东西。那时候做前端控件还是用 jquery，于是就自己写了诸如 **tab**，**dropdown** ，当然顺便也学了 **html** 和 **css** 。即使以当时的眼光来看，这些作品也算不上精致。但我乐在其中。因为一直以来，我用 **java** 写工具，深知 **layout** 和 **event listener** 的繁琐，调试也及其不方便。而运行在浏览器里的 js 太方便了，我要做的只是改代码，刷新，就可以立马看到效果了。我当时心情如下：

![happy.jpg](s-b-vonlanthen-546859-unsplash.jpg)

从此以后，我就“义无反顾”的加入了前端大军。

同时，因为玩的比较多，所以早早就了解到 js 的各种限制，或者说是浏览器环境的诸多限制，譬如不能访问系统资源（本地文件），不能跨域访问资源，等等。但是，这点瑕疵丝毫不能熄灭我对 js 的热爱。

# web app 的优势
上面扯了一大段，大部分没有任何价值，只是写着写着情绪到了。哈哈。

我理解的 **web app** 其实就是传统网站的一种变体。网站是以内容为主，交互为辅，而 web app 则两者平衡（比如**知乎**），甚至有些以交互为主（比如 teambition）。相对于**native app**，web app 的优势是低成本跨平台，free publish（相比 android app 和 ios app 的发布审核），开发成本相对较低。

这里插一句：很多不懂技术被忽悠的进坑，大多是因为轻信了上面的好处。

> 跨频台 -> 更少的开发和测试 -> 更低的成本

套用一句话：**没有银弹**。你得到的多，付出的自然要更多。享受 web app 好处的同时，你不得不接受它的缺陷。

# web app 的劣势，解决办法

web app 依赖浏览器来提供运行环境，相应的，也受制于浏览器的诸多限制。

1. 不能自由的访问本地资源。举个例子，浏览器不允许 js 访问用户文件，那很多基于本地存储的功能（缓存，下载，上传）就做不了。
2. 依赖网络。native app 可以离线工作，web app 却不能。
3. 安全问题。任何人都能查看你的代码，以及各种 storeage。
4. performance。web app 的优化只能止于浏览器，相对的，native app 可以做系统级别的优化。

针对以上缺陷，很多大厂使用 **hybrid app** 技术 - 可以理解为 **web app in native container**。外层容器使用 native 语言开发，内部则加载 web app。容器赋予 web app 诸如文件系统等浏览器不具备的服务，而 web app 则承担复杂多变的业务逻辑和用户界面。

# 低成本方案
玩转 hybrid app 的成本太高，毕竟，你的开发团队需要两种技术人才，一种做 container，一种做 web。好在还有一些免费开源的 container 可以用，比如 [cordova](https://cordova.apache.org/), [electron](https://electronjs.org/)。

可能，某些项目并不需要以上这样**全面**的方案。
**老子只想要流线使用而已啊，说这么多干什么啊魂淡？！**
**就不能发明一种只要开开心心写代码完全不用操心操作系统的ide吗？！**

好，我们继续。上小程序。

## 小程序
过去的一年，很多大厂的**小程序**开始崭露头角。以微信小程序为例，它提供了全面的 **component** 用于构建界面，丰富的 **api** 用于访问硬件资源。程序员只需要编写少量的代码，就可以轻易完成一个app。相比 web app，它可以算得上无脑跨平台 - 因为微信这个容器本身已经对设备本身做了足够抽象，程序员不需要再花费精力做各种适配，解决兼容性问题。简单的说，可以将微信看作一个定制版浏览器，它提供了相比一般浏览器更多的功能，**以及限制**。

如果你想的主要用户来自微信，小程序显然是比 web app 更好的选择。当然，这并不说明 web app 就没有市场了。有志向的大公司或者未来的独角兽们，通常不愿意仰人鼻息。而很多案例证明，腾讯爸爸显然对流量把控很看重。这就是简单的商业问题了。非我所长。

## PWA
web app 不能离线使用，是因为所有的资源都存储在远端。那么，只需要解决如何将资源存在设备上，不就可以了吗？是的，目前已经有这样的 [cache api](https://developer.mozilla.org/en-US/docs/Web/API/Cache) 了，虽然还处于 **Experimental** 中（还未成为 web 标准）。但已经有不错的[兼容性](https://developer.mozilla.org/en-US/docs/Web/API/Cache#Browser_compatibility)了。

![](cache-api-browser-compatibility.PNG)

**PWA**（Progressive Web Apps）是 **google** 在 cache api 和 service worker 的基础上提出的一种 web app 方案。其实，本质上只是在原本的 web app 上又加了一层静态资源存储管理层。具体可以看[官方介绍](https://developers.google.com/web/progressive-web-apps/)。


# 稍微总结一下
web app 开发快上线快，但是限制多。要放开限制，就得脱离浏览器。







